# h5页面键盘呼出问题

## 背景
* 最近在搞H5评论组件。[仓库地址](http://gitlab.alibaba-inc.com/tbc/m-comment)。之前，有很多同学找我询问有没有h5评论组件。我说有，只是不能用，还停留在demo阶段。趁着5月份，爱逛街H5改版的契机，H5的评论组件总算落地。目前代码存在很多瑕疵，比如添加了太多爱逛街的个性化的需求，代码比较臃肿，没有美感。当然，也不乏亮点，或许是唯一的亮点，增加了一项配置，可以对每条评论内容点赞。距离上个版本发布已经过去了一周，还有一些遗留的问题没有解决，其中最大的问题就是键盘呼出的问题。由于键盘呼出功能存在各种bug，呼出功能没有上。这周，花时间对键盘呼出的问题，研究了一下，解决掉了之前键盘呼出的问题。
* 多数情况下，我们会通过文本框的聚焦来呼出软键盘，而且这个文本框会使用position:fixed，定位到页面的底部。今天，我所讨论的情形也是如此。在评论列表里面，用户输入评论内容的评论框也是采用了fixed定位到页面的底部。
* 目前评论组件的评论区域位置见图![截图](http://gtms02.alicdn.com/tps/i2/TB1eS62HVXXXXauXXXX0Y7JRFXX-302-535.png)
* 要使用postion:fixed在移动端的支持情况，参见![fixed支持情况](http://gtms01.alicdn.com/tps/i1/TB1YpDlHVXXXXXGXVXXvuNgQFXX-270-429.png)。由此可见，ios直到5.1版本后才开始支持这个属性。应该支持大部分的手机了。

## 问题
* 主要有两种情况需要考虑，一是页面内容的高度小于浏览器视口高度，二是页面内容的高度大于浏览器视口的高度。在以上两种情况里面，还需要考虑，背景蒙层的滚动情况。我做了几个demo，一起来看看吧。

### 页面内容高度小于浏览器视口高度
* demo:
* 灰色区域是body的高度。我计算了body的高度，即: [document.body.clientHeight](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/clientHeight)，还有视口高度，即[window.innerHeight](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/innerHeight);

### 交互功能
* 点击底部的按钮，按钮会隐藏，同时弹出遮罩和输入框，并且聚焦输入框，使其唤起软键盘。
* 目前看上去是正常的。

### 手淘里面和在浏览器中的区别
* 
* 主要是在浏览器里面，视口高度小于手淘的视口高度，因为浏览器的底部增加了一个操作区域。



